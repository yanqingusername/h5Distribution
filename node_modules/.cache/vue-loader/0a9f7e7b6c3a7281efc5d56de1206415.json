{"remainingRequest":"/Users/user/coyote/h5Distribution/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/user/coyote/h5Distribution/src/pages/login/login.vue?vue&type=style&index=0&id=b8e61588&scoped=true&lang=scss&","dependencies":[{"path":"/Users/user/coyote/h5Distribution/src/pages/login/login.vue","mtime":1660877428013},{"path":"/Users/user/coyote/h5Distribution/node_modules/css-loader/dist/cjs.js","mtime":1652332327372},{"path":"/Users/user/coyote/h5Distribution/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1652332325883},{"path":"/Users/user/coyote/h5Distribution/node_modules/postcss-loader/src/index.js","mtime":1652332330093},{"path":"/Users/user/coyote/h5Distribution/node_modules/sass-loader/dist/cjs.js","mtime":1652332331641},{"path":"/Users/user/coyote/h5Distribution/node_modules/cache-loader/dist/cjs.js","mtime":1652332326496},{"path":"/Users/user/coyote/h5Distribution/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1652332325883}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgpAaW1wb3J0ICIuLi8uLi9hc3NldHMvc3R5bGUvdmFyaWFibGUuc2NzcyI7Ci5sb2dpbi1zZWN0aW9uIHsKICBoZWlnaHQ6IDEwMCU7CiAgZGlzcGxheTogZmxleDsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogIC8vIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgbWFyZ2luLXRvcDogMjAwcHg7CiAgLy8gQGluY2x1ZGUgZmxleENlbnRlcjsKICAuc3VibWl0LWJ0biB7CiAgICB3aWR0aDogNTAwcHg7CiAgfQogIC5yb290X2hlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIC8vIHBhZGRpbmctdG9wOiAyMDBweDsKICB9CgogIC5pY29uX2xvZ28gewogICAgd2lkdGg6IDE3MnB4OwogICAgaGVpZ2h0OiAxNDZweDsKICB9CgogIC5pY29uX2xvZ2luX3RleHQgewogICAgZm9udC1zaXplOiA0OHB4OwogICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0MtU2VtaWJvbGQsIFBpbmdGYW5nIFNDOwogICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIGNvbG9yOiAjMzMzMzMzOwogICAgbGluZS1oZWlnaHQ6IDMzcHg7CiAgICBtYXJnaW4tdG9wOiA2MHB4OwogIH0KCiAgLmljb25fbG9naW5fY29udGVudHsKICAgIGZvbnQtc2l6ZTogMzJweDsKICAgIGZvbnQtZmFtaWx5OiBQaW5nRmFuZ1NDLVNlbWlib2xkLCBQaW5nRmFuZyBTQzsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICBjb2xvcjogIzMzMzMzMzsKICAgIGxpbmUtaGVpZ2h0OiAzM3B4OwogICAgbWFyZ2luLXRvcDogNjBweDsKICB9CgogIC5tYWluIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcGFkZGluZy10b3A6IDUwcHg7CiAgfQogIC5mb3JtLWl0ZW0gewogICAgZGlzcGxheTogZmxleDsKICAgIGhlaWdodDogMTAwcHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwoKICAgIGlucHV0IHsKICAgICAgaGVpZ2h0OiAxMDBweDsKICAgICAgYm9yZGVyOiBub25lOwogICAgICBvdXRsaW5lOiBub25lOwogICAgICB3aWR0aDogNjAwcHg7CiAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZGRkZGRkOwogICAgICBmb250LXNpemU6IDM2cHg7CiAgICAgIGZvbnQtZmFtaWx5OiBQaW5nRmFuZ1NDLVJlZ3VsYXIsIFBpbmdGYW5nIFNDOwogICAgICBmb250LXdlaWdodDogNDAwOwogICAgICBjb2xvcjogIzk5OTk5OTsKICAgIC8vICAgcGFkZGluZzogMHB4IDUwcHg7CiAgICB9CiAgfQoKICAuc3VibWl0X3ZpZXcgewogICAgZGlzcGxheTogZmxleDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIG1hcmdpbi10b3A6IDYwcHg7CiAgICB3aWR0aDogNTAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjMzA3ZmY1OwogICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgY29sb3I6ICNmZmZmZmY7CiAgICBmb250LXNpemU6IDQ0cHg7CiAgfQoKICAuZ2V0X2NvZGUgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgcmlnaHQ6IDI1cHg7CiAgICBmb250LXNpemU6IDM2cHg7CiAgICBmb250LWZhbWlseTogUGluZ0ZhbmdTQy1SZWd1bGFyLCBQaW5nRmFuZyBTQzsKICAgIGZvbnQtd2VpZ2h0OiA0MDA7CiAgICBjb2xvcjogIzMwN2ZmNTsKICAgIGxpbmUtaGVpZ2h0OiAyNXB4OwogIH0KfQo="},{"version":3,"sources":["login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src/pages/login","sourcesContent":["<template>\n  <div class=\"login-section\">\n    <div v-if=\"isShowWechat\">\n      <div class=\"root_header\">\n        <img class=\"icon_logo\" src=\"../../assets/images/icon_logo.png\" alt=\"\" />\n        <div class=\"icon_login_text\">样本箱转运系统</div>\n      </div>\n\n      <div class=\"main\">\n        <div class=\"form-item\">\n          <input\n            v-model=\"phone\"\n            type=\"tel\"\n            name=\"phone\"\n            :oninput=\"phone = (phone.length > 11 ? phone.slice(0, 11) : phone)\"\n            placeholder=\"请输入手机号码\"\n          />\n          <!-- <div class=\"get_code\" @click=\"btnClick\">\n            {{ codeRestTime ? `${codeRestTime}S` : \"获取验证码\" }}\n          </div> -->\n        </div>\n        <div class=\"form-item\" style=\"margin-top: 20px\">\n          <input\n            v-model=\"code\"\n            type=\"password\"\n            name=\"code\"\n            placeholder=\"请输入密码\"\n            :oninput=\"code = (code.length > 6 ? code.slice(0, 6) : code)\"\n          />\n        </div>\n        <!-- <div class=\"submit_view\" @click=\"commit\">登录</div> -->\n        <van-button class=\"submit_view\" block type=\"info\" @click=\"commit\">登录</van-button>\n      </div>\n    </div>\n\n    <div class=\"login-section\" v-else>\n      <div class=\"icon_login_content\">普通浏览器,请在手机微信浏览器打开此页面</div>\n    </div>\n  </div>\n  \n</template>\n\n<script>\nimport { getLogin,getAutoLogin } from \"../../request/api\";\nimport { Notify,Toast } from 'vant';\n\nexport default {\n  name: \"\",\n  components: {},\n  data() {\n    return {\n      code: \"\", // 用户姓名\n      phone: \"\", // 联系电话\n      codeRestTime: 0,\n      restTime: 60,\n      phoneCode: [\"\", \"\"], //正确的 手机号 和 验证码\n      phoneSub: \"\",\n      codeSub: \"\",\n      isShowWechat: true,\n      wxcode: ''\n    };\n  },\n  activated() {},\n  mounted() {\n    this.isWechat();\n    // this.getAutoLogin();\n  },\n  methods: {\n    getUrlCode() {\n      // 截取url中的code方法\n      var url = location.search;\n      var theRequest = new Object();\n      if (url.indexOf(\"?\") != -1) {\n        var str = url.substr(1);\n        var strs = str.split(\"&\");\n        for (var i = 0; i < strs.length; i++) {\n          theRequest[strs[i].split(\"=\")[0]] = strs[i].split(\"=\")[1];\n        }\n      }\n      console.log(theRequest);\n      return theRequest;\n    },\n    isWechat() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      if (ua.match(/micromessenger/i) == 'micromessenger') {\n        console.log('微信浏览器');\n        this.isShowWechat = true;\n        // this.getAutoLogin();\n        let appid = \"wx838527cc11066732\"; //微信APPid\n        let wxcode = this.getUrlCode().code; //是否存在code\n        // let local = 'https://lisalarm.coyotebio-lab.com/index.html';\n        let local = window.location.href\n        alert(local)\n        alert(wxcode)\n        if (wxcode == null || wxcode === \"\") {\n          alert('1111')\n          //不存在就打开上面的地址进行授权\n          window.location.href =\n            \"https://open.weixin.qq.com/connect/oauth2/authorize?appid=\" +\n            appid +\n            \"&redirect_uri=\" +\n            encodeURIComponent(local) +\n            \"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect\";\n\n            // https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx838527cc11066732&redirect_uri=https://lisalarm.coyotebio-lab.com/paiban/index.html&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect\n\n        } else {\n          alert('2222')\n          alert('---->:',wxcode)\n          this.wxcode = wxcode;\n        }\n        return true;\n      } else {\n        this.isShowWechat = false;\n        console.log('普通浏览器,请在手机微信浏览器打开此页面');\n        return false;\n      }\n    },\n    checkPhone(phone) {\n      var phoneReg = /^1\\d{10}$/;\n      if (phone.length != 11) {\n        return false;\n      } else if (!phoneReg.test(phone)) {\n        return false;\n      } else {\n        return true;\n      }\n    },\n    btnClick() {\n      let that = this;\n      if (this.phone == \"\") {\n        Toast('请填写手机号')\n          // Notify({ type: 'danger', message: '请填写手机号'});\n        // alert(\"请填写手机号\");\n      } else if (!this.checkPhone(this.phone)) {\n        Toast('手机号有误')\n          // Notify({ type: 'danger', message: '手机号有误'});\n        // alert(\"手机号有误\");\n      } else {\n        this.codeRestTime = this.restTime;\n        let timer = setInterval(() => {\n          --this.codeRestTime;\n          if (!this.codeRestTime) {\n            clearInterval(timer);\n            timer = null;\n          }\n        }, 1000);\n\n        getVerification({\n          phone: this.phone,\n        }).then((res) => {\n          if (res.data.success) {\n              console.log(res.data.msg)\n              that.phoneSub = res.data.phone;\n              that.codeSub = res.data.msg;\n            // that.phoneCode[(that.phone, res.msg)];\n          } else {\n            // alert(\"验证码发送失败\");\n            Toast(res.data.msg)\n            // Notify({ type: 'primary', message:  res.msg});\n          }\n        });\n      }\n    },\n    commit() {\n      alert(this.wxcode)\n      if (this.phone == \"\") {\n        Toast('请填写手机号')\n          //  Notify({ type: 'danger', message: '请填写手机号'});\n        return;\n      } else if (!this.checkPhone(this.phone)) {\n        Toast('手机号有误')\n          // Notify({ type: 'danger', message: '手机号有误'});\n        return;\n      // } else if (this.code == \"\") {\n      //   Toast('请填写验证码')\n      //     // Notify({ type: 'danger', message: '请填写验证码'});\n      //   return;\n      // } else if (this.phoneSub == \"\") {\n      //   Toast('请获取验证码')\n      //   // Notify({ type: 'danger', message: '请获取验证码'});\n      //   return;\n      // } else if (this.phoneSub != this.phone) {\n      //   Toast('验证码过期')\n      //     // Notify({ type: 'danger', message: '验证码过期'});\n      //   return;\n      // } else if (this.codeSub != this.code) {\n      //   Toast('验证码错误')\n      //     // Notify({ type: 'danger', message: '验证码错误'});\n      //   return;\n      } else {\n        getLogin({\n          phone: this.phone,\n          password: this.code\n        }).then((res) => {\n          console.log(res)\n          if (res.data.success) {\n            Toast(res.data.msg)\n            localStorage.setItem('conveyPhone',this.phone);\n            localStorage.setItem('conveyPassword',this.code)\n            this.$router.push({\n                path: \"/instrumentList\",\n                query:{id: res.data.roleId,name: res.data.name,userId: res.data.userId}\n            });\n          } else {\n            Toast(res.data.msg)\n          }\n        });\n      }\n    },\n    handleLogin() {\n      this.$router.push({\n        path: \"/instrumentList\",\n        query:{id: 1 || res.data.roleId}\n      });\n    },\n    getAutoLogin(){\n      let phone = localStorage.getItem('conveyPhone');\n      let password = localStorage.getItem('conveyPassword');\n      if(phone && password){\n        this.phone = phone;\n        this.code = password;\n        getAutoLogin({\n          phone: phone,\n          password: password\n        }).then((res) => {\n          console.log(res)\n          if (res.data.success) {\n            this.phone = '';\n            this.code = '';\n            Toast(res.data.msg)\n            this.$router.push({\n                path: \"/instrumentList\",\n                query:{id: res.data.roleId,name: res.data.name,userId: res.data.userId}\n            });\n          } else {\n            Toast(res.data.msg)\n          }\n        });\n      }\n    }\n  },\n};\n</script>\n<style scoped lang=\"scss\">\n@import \"../../assets/style/variable.scss\";\n.login-section {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  // justify-content: center;\n  align-items: center;\n  margin-top: 200px;\n  // @include flexCenter;\n  .submit-btn {\n    width: 500px;\n  }\n  .root_header {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    // padding-top: 200px;\n  }\n\n  .icon_logo {\n    width: 172px;\n    height: 146px;\n  }\n\n  .icon_login_text {\n    font-size: 48px;\n    font-family: PingFangSC-Semibold, PingFang SC;\n    font-weight: 600;\n    color: #333333;\n    line-height: 33px;\n    margin-top: 60px;\n  }\n\n  .icon_login_content{\n    font-size: 32px;\n    font-family: PingFangSC-Semibold, PingFang SC;\n    font-weight: 600;\n    color: #333333;\n    line-height: 33px;\n    margin-top: 60px;\n  }\n\n  .main {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    padding-top: 50px;\n  }\n  .form-item {\n    display: flex;\n    height: 100px;\n    position: relative;\n    align-items: center;\n\n    input {\n      height: 100px;\n      border: none;\n      outline: none;\n      width: 600px;\n      border-bottom: 1px solid #dddddd;\n      font-size: 36px;\n      font-family: PingFangSC-Regular, PingFang SC;\n      font-weight: 400;\n      color: #999999;\n    //   padding: 0px 50px;\n    }\n  }\n\n  .submit_view {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    margin-top: 60px;\n    width: 500px;\n    background: #307ff5;\n    border-radius: 6px;\n    color: #ffffff;\n    font-size: 44px;\n  }\n\n  .get_code {\n    position: absolute;\n    right: 25px;\n    font-size: 36px;\n    font-family: PingFangSC-Regular, PingFang SC;\n    font-weight: 400;\n    color: #307ff5;\n    line-height: 25px;\n  }\n}\n</style>"]}]}